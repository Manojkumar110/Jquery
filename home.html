<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Jquery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="img/jquery.png">
</head>

<body>
    <div class="container">
        <div class="row mt-3 text-center">
            <div class="col-1">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#headingModal">
                    Heading
                </button>
            </div>
            <div class="col-2">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#subHeadingModal">
                    Sub Heading
                </button>
            </div>
            <div class="col-1">
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#formModal">
                    Form
                </button>
            </div>
        </div>
    </div>
    <!-- Heading Section -->
    <div class="modal fade" id="headingModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Heading</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="" class="select-heading">
                    <div class="modal-body">
                        <input type="text" class="form-control" placeholder="Please Enter Heading" required>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- Sub Heading Section -->
    <div class="modal fade" id="subHeadingModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Sub Heading</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="" class="select-sub-heading">
                    <div class="modal-body">
                        <select class="form-select mt-3" aria-label="Default select example">
                            <option value="heading" selected disabled>Please Select Heading</option>
                        </select>
                        <input type="text" class="form-control mt-3" placeholder="Please Enter Sub Heading" required>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Form Section -->

    <div class="modal fade" id="formModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Form</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="" onsubmit="return false" class="select-sub-heading select-form">
                    <div class="modal-body">
                        <select class="form-select formheading" id="headings" name="formheading"
                            aria-label="Default select example">
                            <option value="">Please Select Heading</option>
                        </select><br>

                        <select class="form-select subheadingform mt-3" id="subheadingformid"
                            aria-label="Default select example">
                            <option value="subheading" selected disabled>Please Select Sub Heading</option>
                        </select>

                        <select id="controlType" class="form-select mt-3" aria-label="Default select example">
                            <option value="" selected disabled>Select Input Type</option>
                            <option>button</option>
                            <option>checkbox</option>
                            <option>color</option>
                            <option>date</option>
                            <option>email</option>
                            <option>file</option>
                            <option>hidden</option>
                            <option>image</option>
                            <option>month</option>
                            <option>number</option>
                            <option>password</option>
                            <option>radio</option>
                            <option>range</option>
                            <option>reset</option>
                            <option>search</option>
                            <option>submit</option>
                            <option>tel</option>
                            <option>text</option>
                            <option>time</option>
                            <option>url</option>
                            <option>week</option>
                        </select>
                        <input type="text" name="" placeholder="Label" class="form-control label mt-3">
                        <input type="text" placeholder="Name" class="form-control name mt-3">
                        <input type="text" placeholder="Class" class="form-control class mt-3">
                        <input type="text" name="" placeholder="Id" class="form-control id mt-3">
                        <input type="text" name="" placeholder="Value" class="form-control value mt-3">
                        <input type="text" name="" placeholder="Action" class="form-control action mt-3">
                        <input type="text" name="" placeholder="Option" class="form-control option mt-3">
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="container-fluid mt-3">
        <div class="row" id="rowid">
            <div class="card col-lg-7 ms-4">
                <main id="mainContainer">

                </main>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>
        //heading section
        $(document).ready(function () {
            var heading = getLocalStorage("Heading");
            if (heading) {
                $("#mainContainer").append(heading);
            }
            $(".select-heading").on('submit', function (e) {
                var heading = $('input').val()
                $("main").append('<section><h1>' + heading + '<button class="remove btn btn-danger" onclick="removeFun(this)">X</button></h1></section>')
                $('.select-sub-heading option').remove()
                $('.select-sub-heading select').append("<option value='' selected disabled>Please Select Heading</option>")

                $('.select-form #headings option').remove()
                $('.select-form #headings').append("<option value='' selected disabled> Please Select Heading</option>")

                $('section h1').each(function (key) {
                    key = key + 1
                    var heading_in_sub_heading = $(this).text()
                    // console.log('heading in sub heading :', heading_in_sub_heading)
                    $('.select-form #headings').append("<option value=" + key + ">" + heading_in_sub_heading + "</option>")
                    $('.select-sub-heading select').append("<option value=" + key + ">" + heading_in_sub_heading + "</option>")

                })
                e.preventDefault();
                e.target.reset();
                setLocalStorage();
            })
        });

        //Sub Heading Section :-
        $(document).ready(function () {
            $('section h1').each(function (key) {
                key = key + 1
                var heading_in_sub_heading = $(this).text()
                $('.select-sub-heading select').append("<option value=" + key + ">" + heading_in_sub_heading + "</option>")
            })

            $(".select-sub-heading").on('submit', function (e) {
                var heading_in_sub_heading = $('select option:selected', this).val()
                var sub_heading = $('input', this).val()
                $("section:nth-child(" + heading_in_sub_heading + ")").append('<div class="container  mt-1"><h4 class="subheadingtxt">' + sub_heading + '<button class="remove btn btn-danger" onclick="removeFun(this)">X</button></h4></div>')

                $('.select-form #subheadingformid option').remove()
                $('.select-form #subheadingformid').append("<option value='' selected disabled>Select Heading</option>")
                $('section .container h4').each(function (key) {
                    key = key + 1
                    $(this).text()
                    e.preventDefault();
                    e.target.reset();
                    setLocalStorage();
                })
            })
        });



        // form section :- 
        
        $(document).ready(function () {
            $('section h1').each(function (key) {
                key = key + 1
                var heading_in_sub_heading = $(this).text()
                $('.select-form #subheadingformid').append("<option value='' selected disabled>Please Select Heading</option>")
            })

            var subheading = [];
            $('.formheading').on('change', function (e) {
                e.preventDefault();
                var heading_in_sub_heading = $('.formheading option:selected').val()
                $('.select-form #subheadingformid option').remove()
                $('.select-form #subheadingformid').append("<option value='' selected disabled>Please Select Heading</option>")
                subheading = []
                $("section:nth-child(" + heading_in_sub_heading + ") div h4").each(function (key) {
                    subheading.push($(this).text())
                })

                $.each(subheading, function (index, itemData) {
                    $('#subheadingformid').append($("<option></option>")
                        .attr("value", index + 2)
                        .text(itemData));
                });

            })

            $(".select-form").on('submit', function () {
                
                var h = $('.formheading option:selected').val()

                var sh = $('.subheadingform option:selected').val()

                $('.form-select').change(function () {
                    var v = $(this).val()
                })

                var controlType = $('#controlType').val();
                var label = $('.ilabel').val()
                var classes = $('.iclass').val()
                var id = $('.iid').val()
                var placeholder = $('.iplaceholder').val()
                var value = $('.ivalue').val()
                var name = $('.iname').val()
                var action = $('.iaction').val()
                var option = $('.ioption').val()

                var element = "<input type=' + controlType + ' label=' + label + ' class=' + classes + ' id=' + id + ' placeholder=' + placeholder + ' value=' + value + ' name=' + name + ' action=' + action + ' option=' + option + '/><br>"
                $('main section:nth-child(' + h + ') div:nth-child(' + sh + ')').append('<p>' + element + '<button class="remove btn-danger" onclick="removFun(this)">X</button></p>')
                setLocalStorage();
            })
        });


        function setLocalStorage() {
            var selectValue = $('#mainContainer').html();
            localStorage.setItem("Heading", selectValue);
        };

        function getLocalStorage(property) {
            return localStorage.getItem(property);
        };

        // dragdrop

        $(document).ready(function () {
            $('#mainContainer').sortable({
                change: function (event, ui) { setLocalStorage() },
                update: function (event, ui) { setLocalStorage() },
                connectWith: '#mainContainer'
            });

            $('.container').sortable({
                change: function (event, ui) { setLocalStorage() },
                update: function (event, ui) { setLocalStorage() },
                connectWith: '.container',
                cancel: 'h4, button'
            });

            $('section').sortable({
                change: function (event, ui) { setLocalStorage() },
                update: function (event, ui) { setLocalStorage() },
                connectWith: 'section',
                cancel: 'h1, button'
            });

            setLocalStorage();
        });


        function removeFun(remove) {
            $(remove).parent().remove();
            setLocalStorage();
        }
    </script>
</body>

</html>